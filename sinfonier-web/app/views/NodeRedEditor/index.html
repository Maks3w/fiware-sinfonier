#{extends 'Layouts/darwin-control-panel-layout.html' /}
#{set 'title'} Sinfonier - &{'Drawer.index.title'} #{/set}
#{set 'moreStyles'}
  <link href="@{'public/stylesheets/newEditor/jquery-ui-1.10.3.custom.min.css'}" rel="stylesheet" media="screen">
  <link rel="stylesheet" href="@{'public/stylesheets/newEditor/vendor.css'}">
  <link rel="stylesheet" href="@{'public/stylesheets/newEditor/style.min.css'}">
  #{stylesheet 'drawer.css' /}
  #{stylesheet 'newEditor/newEditor.css' /}
#{/set}

<div id="header">
    <ul class="header-toolbar hide">
        <li><a id="btn-sidemenu" class="button" data-toggle="dropdown" href="#"><i class="fa fa-bars"></i></a></li>
    </ul>
    <div id="header-shade" class="hide"></div>
</div>
<div id="main-container" class="sidebar-closed hide">
    <div id="workspace">
        <ul id="workspace-tabs"></ul>
        <div id="chart" tabindex="1"></div>
        <div id="workspace-toolbar"></div>
        <div id="workspace-footer">
            <a class="workspace-footer-button" id="btn-zoom-out" href="#"><i class="fa fa-minus"></i></a>
            <a class="workspace-footer-button" id="btn-zoom-zero" href="#"><i class="fa fa-circle-o"></i></a>
            <a class="workspace-footer-button" id="btn-zoom-in" href="#"><i class="fa fa-plus"></i></a>
        </div>
        <div id="editor-shade" class="hide"></div>
    </div>
    <div id="editor-stack"></div>
    <div id="palette">
        <img src="public/images/newEditor/spin.svg" class="palette-spinner hide"/>
        <div id="palette-search" class="palette-search hide">
            <input type="text" data-i18n="[placeholder]palette.filter"></input>
        </div>
        <div id="palette-editor">
            <div class="editor-tray-header"><div class="editor-tray-titlebar"><ul class="editor-tray-breadcrumbs"><li data-i18n="palette.editor.title"></li></ul></div><div class="editor-tray-toolbar"><button id="palette-editor-close" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only primary" role="button" aria-disabled="false" data-i18n="common.label.done"></button></div></div>
            <ul id="palette-editor-tabs"></ul>
        </div>
        <div id="palette-container" class="palette-scroll hide"></div>
        <div id="palette-footer">
            <a class="palette-button" id="palette-collapse-all" href="#"><i class="fa fa-angle-double-up"></i></a>
            <a class="palette-button" id="palette-expand-all" href="#"><i class="fa fa-angle-double-down"></i></a>
        </div>
        <div id="palette-shade" class="hide"></div>
    </div><!-- /palette -->
    <div id="sidebar">
        <ul id="sidebar-tabs"></ul>
        <div id="sidebar-content"></div>
        <div id="sidebar-footer"></div>
        <div id="sidebar-shade" class="hide"></div>
    </div>

    <div id="sidebar-separator"></div>

</div>

<div id="notifications"></div>
<div id="dropTarget"><div data-i18n="[append]workspace.dropFlowHere"><br/><i class="fa fa-download"></i></div></div>

<div id="node-dialog-confirm-deploy" class="hide">
    <form class="form-horizontal">
        <div id="node-dialog-confirm-deploy-config" style="text-align: left; padding-top: 30px;" data-i18n="[prepend]deploy.confirm.improperlyConfigured;[append]deploy.confirm.confirm">
            <ul style="font-size: 0.9em; width: 400px; margin: 10px auto; text-align: left;" id="node-dialog-confirm-deploy-invalid-list"></ul>
        </div>
        <div id="node-dialog-confirm-deploy-unknown" style="text-align: left; padding-top: 10px;" data-i18n="[prepend]deploy.confirm.unknown;[append]deploy.confirm.confirm">
            <ul style="font-size: 0.9em; width: 400px; margin: 10px auto; text-align: left;" id="node-dialog-confirm-deploy-unknown-list"></ul>
        </div>
        <div id="node-dialog-confirm-deploy-conflict" style="text-align: left; padding-top: 10px;" data-i18n="[prepend]deploy.confirm.conflict;[append]deploy.confirm.confirm">
        </div>
    </form>
</div>
<div id="node-dialog-view-diff" class="hide">
    <ol id="node-dialog-view-diff-diff"></ol>
</div>

<div id="node-dialog-library-save-confirm" class="hide">
    <form class="form-horizontal">
        <div style="text-align: center; padding-top: 30px;" id="node-dialog-library-save-content">
        </div>
    </form>
</div>

<div id="node-dialog-library-save" class="hide">
    <form class="form-horizontal">
        <div class="form-row">
            <label for="node-dialog-library-save-folder" data-i18n="[append]library.folder"><i class="fa fa-folder-open"></i> </label>
            <input type="text" id="node-dialog-library-save-folder" data-i18n="[placeholder]library.folderPlaceholder">
        </div>
        <div class="form-row">
            <label for="node-dialog-library-save-filename" data-i18n="[append]library.filename"><i class="fa fa-file"></i> </label>
            <input type="text" id="node-dialog-library-save-filename" data-i18n="[placeholder]library.filenamePlaceholder">
        </div>
    </form>
</div>

<div id="node-dialog-library-lookup" class="hide">
    <form class="form-horizontal">
        <div class="form-row">
            <ul id="node-dialog-library-breadcrumbs" class="breadcrumb">
                <li class="active"><a href="#" data-i18n="[append]library.breadcrumb"></a></li>
            </ul>
        </div>
        <div class="form-row">
            <div style="vertical-align: top; display: inline-block; height: 100%; width: 30%; padding-right: 20px;">
                <div id="node-select-library" style="border: 1px solid #999; width: 100%; height: 100%; overflow:scroll;"><ul></ul></div>
            </div>
            <div style="vertical-align: top; display: inline-block;width: 65%; height: 100%;">
                <div style="height: 100%; width: 95%;" class="node-text-editor" id="node-select-library-text" ></div>
            </div>
        </div>
    </form>
</div>
<script type="text/x-red" data-template-name="subflow">
    <div class="form-row">
        <label for="node-input-name" data-i18n="[append]editor:common.label.name"><i class="fa fa-tag"></i> </label>
        <input type="text" id="node-input-name">
    </div>
</script>

<script type="text/x-red" data-template-name="subflow-template">
    <div class="form-row">
        <label for="subflow-input-name" data-i18n="common.label.name"></label><input type="text" id="subflow-input-name">
    </div>
    <div class="form-row" style="margin-bottom: 0px;">
        <label for="subflow-input-info" data-i18n="subflow.info"></label>
        <a href="https://help.github.com/articles/markdown-basics/" style="font-size: 0.8em; float: right;" data-i18n="[html]subflow.format"></a>
    </div>
    <div class="form-row node-text-editor-row">
        <div style="height: 250px;" class="node-text-editor" id="subflow-input-info-editor"></div>
    </div>
    <div class="form-row form-tips" id="subflow-dialog-user-count"></div>
</script>

#{i18n /}
#{set 'moreScripts'}
  <script type="text/javascript">
    %{
      models.validators.ParamsValidator validator = models.validators.ParamsValidator.getInstance();
      models.storm.Params params = validator.getParams();
    }%
    var propertiesForm = '<div class="editor-tray-body-wrapper"><div class="editor-tray-body"><form id="properties-form" class="form-horizontal">'+
      '<div class="form-group">'+
           '<label for="properties-name"><span>'+i18n('Drawer.editor.properties.label.topologyName')+'</span></label>'+
           '<input id="properties-name" type="text" name="name" placeholder="'+ i18n('Drawer.editor.properties.placeholder.topologyName')+'">'+
      '</div>'+
      '<div class="form-group">'+
          '<label for="properties-description"><span>'+i18n('Drawer.editor.properties.label.topologyDescription')+'</span></label>'+
          '<textarea id="properties-description" rows="2" cols="30" name="description"></textarea>'+
      '</div>';
    #{if models.SinfonierConstants.Drawer.IS_ACTIVE_N_WORKERS}
      propertiesForm = propertiesForm + '<div class="form-group">'+
        '<label for="properties-topology-workers"><span>'+i18n('Nodered.sidebar.properties.label.stormNumWorkers')+'</span></label>'+
        '<input id="properties-topology-workers" type="text" name="TOPOLOGY_WORKERS" placeholder="'+ i18n('Drawer.editor.properties.placeholder.stormNumWorkers', ${params.getParams().get('TOPOLOGY_WORKERS').getMinRange()}, ${params.getParams().get('TOPOLOGY_WORKERS').getMaxRange()})+'">'+
        '</div>';
    #{/if}
    #{if models.SinfonierConstants.Drawer.IS_ACTIVE_SPOUT_PENDING}
      propertiesForm = propertiesForm + '<div class="form-group">'+
        '<label for="properties-name"><span>'+i18n('Drawer.editor.properties.label.maxSpoutsPending')+'</span></label>'+
        '<input id="properties-topology-max-spout-pending" type="text" name="TOPOLOGY_MAX_SPOUT_PENDING" placeholder="'+ i18n('Drawer.editor.properties.placeholder.maxSpoutsPending', ${params.getParams().get('TOPOLOGY_MAX_SPOUT_PENDING').getMinRange()}, ${params.getParams().get('TOPOLOGY_MAX_SPOUT_PENDING').getMaxRange()})+'">'+
        '</div>';
    #{/if}
    #{if models.SinfonierConstants.Drawer.IS_ACTIVE_MSG_TIMEOUT}
      propertiesForm = propertiesForm + '<div class="form-group">'+
        '<label for="properties-name"><span>'+i18n('Nodered.sidebar.properties.label.topologyMessageTimeout')+'</span></label>'+
        '<input id="properties-topology-message-timeout-secs" type="text" name="TOPOLOGY_MESSAGE_TIMEOUT_SECS" placeholder="'+ i18n('Drawer.editor.properties.placeholder.topologyMessageTimeout', ${params.getParams().get('TOPOLOGY_MESSAGE_TIMEOUT_SECS').getMinRange()}, ${params.getParams().get('TOPOLOGY_MESSAGE_TIMEOUT_SECS').getMaxRange()})+'">'+
        '</div>';
    #{/if}
    #{if models.SinfonierConstants.Drawer.IS_ACTIVE_EXTRA_PARAMS}
      propertiesForm = propertiesForm +'<div class="form-group">'+
        '<label for="properties-description"><span>'+i18n('Nodered.sidebar.properties.label.stormConfiguration')+'</span></label>'+
        '<textarea id="properties-extra-configuration" rows="2" cols="30" name="extraConfiguration" placeholder="'+ i18n('Drawer.editor.properties.placeholder.stormConfiguration')+'"></textarea>'+
        '</div>';    
    #{/if}

    propertiesForm = propertiesForm +'<div class="form-group">'+
      '<label for="properties-topology-properties"><span>'+i18n('Drawer.editor.properties.label.topologyConfiguration')+'</span></label>'+
      '<textarea id="properties-topology-properties" rows="4" cols="30" name="topologyProperties" placeholder="'+ i18n('Drawer.editor.properties.placeholder.topologyConfiguration') +'"></textarea>'+
      '</div>'+
      '</form></div></div>';

  </script>
    #{script 'newEditor/vendor.js'/}
    #{script 'newEditor/ace.js'/}
    #{script 'newEditor/ext-language_tools.js'/}
    #{script 'newEditor/red.js'/}
    #{script 'newEditor.js'/}
    <script type="text/javascript">
        $(document).ready(function () {
            $('#btn-sidemenu').dropdown();
        });
   </script>
#{/set}    
